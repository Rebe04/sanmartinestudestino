import{a as S,r as n,j as e,L as O}from"./app-OVZ64_XX.js";import{F as U,A as $}from"./AdminLayout-Bjroeuxh.js";import{P as w}from"./PrimaryButton-CeYxX5MF.js";import{I as l}from"./InputLabel-B-4kZ5Of.js";import{T as g}from"./TextInput-JlCf7FAI.js";import{I as c}from"./InputError-CmHgD06q.js";import{D as T}from"./DishCard-wJLKvXTh.js";import{M as W,S as q}from"./SecondaryButton-CEBeL-YL.js";import{F as z}from"./PhotoIcon-BP88Av4y.js";import"./ApplicationLogo-DTxGL7cS.js";import"./logoWhite-C0-n3M0p.js";import"./NewspaperIcon-BU7itNwp.js";import"./MapIcon-MjAidHm7.js";import"./Dropdown-1jmJX_RV.js";import"./transition-DRn2MT8c.js";import"./TrashIcon-CrZfbaui.js";import"./index-YMeVSLMw.js";function V({foodCategories:h}){const{data:a,setData:d,post:D,processing:C,errors:o}=S({name:"",address:"",description:"",food_category_id:"",images:[],dishes:[]}),[k,j]=n.useState(!1),v=n.useRef(null),y=s=>{const t=Array.from(s).filter(i=>i.type!=="image/webp"?(alert(`El archivo '${i.name}' no es WEBP.`),!1):i.size>1048576?(alert(`El archivo '${i.name}' pesa más de 1MB.`),!1):!0);d("images",[...a.images,...t])},u=s=>{s.preventDefault(),s.stopPropagation(),j(s.type==="dragenter"||s.type==="dragover")},F=s=>{s.preventDefault(),s.stopPropagation(),j(!1),s.dataTransfer.files&&y(s.dataTransfer.files)},R=s=>{s.preventDefault(),s.target.files&&y(s.target.files)},I=()=>{v.current.click()},E=s=>{d("images",a.images.filter((t,i)=>i!==s))},[m,x]=n.useState({name:"",image:null}),p=n.useRef(null),P=()=>{if(!m.name.trim()||!m.image){alert("Por favor, completa el nombre y la imagen del plato.");return}d("dishes",[...a.dishes,m]),x({name:"",image:null}),p.current&&(p.current.value="")},[_,N]=n.useState(!1),[r,f]=n.useState({index:null,data:{}}),A=n.useRef(null),G=(s,t)=>{f({index:t,data:{...s}}),N(!0)},b=()=>N(!1),B=()=>{const s=[...a.dishes];s[r.index]=r.data,d("dishes",s),b()},L=s=>{d("dishes",a.dishes.filter((t,i)=>i!==s))},M=s=>{s.preventDefault(),D(route("admin.restaurants.store"),{forceFormData:!0})};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold text-smd-dark mb-6",children:"Crear Nuevo Restaurante"}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-smd-dark",children:"Información del Restaurante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",value:"Nombre del Restaurante"}),e.jsx(g,{id:"name",value:a.name,onChange:s=>d("name",s.target.value),className:"mt-1 block w-full",isFocused:!0}),e.jsx(c,{message:o.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"food_category_id",value:"Categoría"}),e.jsxs("select",{id:"food_category_id",value:a.food_category_id,onChange:s=>d("food_category_id",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Selecciona una categoría"}),h.data.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(c,{message:o.food_category_id,className:"mt-2"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"address",value:"Dirección"}),e.jsx(g,{id:"address",value:a.address,onChange:s=>d("address",s.target.value),className:"mt-1 block w-full"}),e.jsx(c,{message:o.address,className:"mt-2"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"description",value:"Descripción"}),e.jsx("textarea",{id:"description",value:a.description,onChange:s=>d("description",s.target.value),rows:"4",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e.jsx(c,{message:o.description,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-smd-dark",children:"Galería de Imágenes"}),e.jsxs("div",{onDragEnter:u,onDragLeave:u,onDragOver:u,onDrop:F,className:`p-6 border-2 border-dashed rounded-md flex flex-col items-center justify-center text-center ${k?"border-smd-soft-green bg-green-50":"border-gray-300"}`,children:[e.jsx("input",{ref:v,type:"file",multiple:!0,accept:"image/webp",className:"hidden",onChange:R}),e.jsx(z,{className:"h-12 w-12 text-gray-400"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Arrastra y suelta tus imágenes aquí"}),e.jsx("p",{className:"text-sm text-gray-400 my-2",children:"o"}),e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 bg-gray-200 rounded-md text-sm font-semibold hover:bg-gray-300",children:"Seleccionar Archivos"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"WEBP de menos de 1MB cada una."})]}),a.images.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:a.images.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:`preview ${t}`,className:"w-full h-24 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>E(t),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-0.5",children:e.jsx(U,{className:"h-5 w-5"})})]},t))}),e.jsx(c,{message:o.images,className:"mt-2"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-smd-dark",children:"Platos Destacados"}),e.jsxs("div",{className:"p-4 border-dashed border-2 rounded-md mb-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"newDishName",value:"Nombre del Plato"}),e.jsx(g,{id:"newDishName",value:m.name,onChange:s=>x({...m,name:s.target.value}),className:"w-full mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"newDishImage",value:"Imagen (WEBP, <1MB)"}),e.jsx("input",{ref:p,id:"newDishImage",type:"file",accept:"image/webp",onChange:s=>x({...m,image:s.target.files[0]}),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-smd-soft-green/10 file:text-smd-soft-green hover:file:bg-smd-soft-green/20"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",onClick:P,className:"bg-smd-dark text-white px-4 py-2 rounded-md font-semibold text-sm hover:bg-gray-700 transition-colors",children:"Añadir Plato"})})]}),e.jsxs("h3",{className:"text-lg font-medium text-gray-600 mb-4",children:["Platos a Añadir: ",a.dishes.length]}),e.jsx("div",{className:"space-y-4",children:a.dishes.map((s,t)=>e.jsx(T,{dish:s,onRemove:()=>L(t),onEdit:()=>G(s,t)},t))}),Object.keys(o).filter(s=>s.startsWith("dishes.")).map(s=>e.jsx(c,{message:o[s],className:"mt-2"},s))]}),e.jsxs("div",{className:"mt-6 flex justify-end items-center gap-smd-16",children:[e.jsx(O,{href:route("admin.restaurants.index"),className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50",children:"Cancelar"}),e.jsx(w,{className:"px-6 py-2 bg-smd-soft-green text-white font-bold rounded-lg hover:bg-green-700 disabled:bg-gray-400",disabled:C,children:"Guardar Restaurante"})]})]}),e.jsx(W,{show:_,onClose:b,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Editar Plato"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"editDishName",value:"Nombre del Plato"}),e.jsx(g,{id:"editDishName",value:r.data.name,onChange:s=>f({...r,data:{...r.data,name:s.target.value}}),className:"w-full mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"editDishImage",value:"Cambiar Imagen (Opcional)"}),e.jsx("input",{ref:A,id:"editDishImage",type:"file",accept:"image/webp",onChange:s=>f({...r,data:{...r.data,image:s.target.files[0]}}),className:"mt-1 block w-full text-sm ..."})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Vista Previa:"}),e.jsx("img",{src:typeof r.data.image=="string"?r.data.image:r.data.image?URL.createObjectURL(r.data.image):"",className:"w-24 h-24 object-cover rounded-md mt-1 border"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end items-center gap-smd-16",children:[e.jsx(q,{className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50",onClick:b,children:"Cancelar"}),e.jsx(w,{onClick:B,className:"px-6 py-2 bg-smd-soft-green text-white font-bold rounded-lg hover:bg-green-700 disabled:bg-gray-400",children:"Guardar Cambios"})]})]})})]})}V.layout=h=>e.jsx($,{children:h,title:"Crear un Restaurante"});export{V as default};
