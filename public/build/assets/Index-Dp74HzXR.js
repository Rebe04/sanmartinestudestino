import{r as d,a as F,j as e,L as m}from"./app-Bz-5Z4is.js";import{A as D}from"./AdminLayout-BR_SnIj5.js";import{P as S}from"./Pagination-BvzeB1mA.js";import{M as A,S as T}from"./SecondaryButton-B4YnYHWs.js";import{D as $}from"./DangerButton-BGBva8Gb.js";import{F as _,a as g,b}from"./TrashIcon-CCwCsWbf.js";import{F as w}from"./CheckIcon-CPJLVF1V.js";import{a as y,F as v}from"./QrCodeIcon-CqIoqbyl.js";import"./ApplicationLogo-_2FCZUPo.js";import"./logoWhite-C0-n3M0p.js";import"./NewspaperIcon-ComPTQJC.js";import"./MapIcon-fH06Owzl.js";import"./Dropdown-CHgtJ0wJ.js";import"./transition-CBmOGeRb.js";import"./index-BG1TdIkX.js";function q({routes:n}){const{data:i,meta:R}=n,[x,l]=d.useState(null),h=s=>{const o=window.route("routes.show",s.slug);if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(o).then(()=>{l(s.id),setTimeout(()=>l(null),2e3)}).catch(t=>{console.error("Error al copiar la URL (moderno): ",t),alert("No se pudo copiar la URL.")});else{const t=document.createElement("textarea");t.value=o,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),l(s.id),setTimeout(()=>l(null),2e3)}catch(a){console.error("Error al copiar la URL (antiguo): ",a),alert("No se pudo copiar la URL.")}document.body.removeChild(t)}},p=s=>{const o=window.route("routes.show",s.slug),t=`https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(o)}`;fetch(t).then(a=>{if(!a.ok)throw new Error("Network response was not ok");return a.blob()}).then(a=>{const N=window.URL.createObjectURL(a),r=document.createElement("a");r.href=N,r.setAttribute("download",`qr-${s.slug}.png`),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r),window.URL.revokeObjectURL(N)}).catch(a=>{console.error("Error al descargar el QR:",a),alert("No se pudo descargar el código QR.")})},[C,u]=d.useState(!1),[j,k]=d.useState(null),{delete:E,processing:U}=F(),f=s=>{k(s),u(!0)},c=()=>u(!1),L=s=>{s.preventDefault(),E(route("admin.routes.destroy",j.slug),{onSuccess:()=>c()})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-smd-dark",children:"Rutas Turísticas"}),e.jsxs(m,{href:route("admin.routes.create"),className:"inline-flex items-center gap-2 bg-smd-soft-green text-white font-bold px-4 py-2 rounded-lg hover:bg-green-700",children:[e.jsx(_,{className:"h-5 w-5"}),"Crear Ruta"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("table",{className:"w-full hidden md:table",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-left text-sm font-semibold text-gray-600 uppercase",children:"Nombre"}),e.jsx("th",{className:"p-4 text-center text-sm font-semibold text-gray-600 uppercase",children:"Paradas"}),e.jsx("th",{className:"p-4 text-left text-sm font-semibold text-gray-600 uppercase",children:"Tiempo Estimado"}),e.jsx("th",{className:"p-4 text-left text-sm font-semibold text-gray-600 uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"p-4 flex items-center",children:[e.jsx("img",{src:s.image_url,alt:s.name,className:"w-10 h-10 rounded-md object-cover mr-4 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"font-bold text-smd-dark",children:s.name})})]}),e.jsx("td",{className:"p-4 text-center text-gray-700 font-medium",children:s.stops_count}),e.jsx("td",{className:"p-4 text-gray-700",children:s.time}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{href:route("admin.routes.edit",s.slug),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:e.jsx(g,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>h(s),className:"text-gray-500 hover:text-smd-soft-green relative",title:"Copiar URL",children:x===s.id?e.jsx(w,{className:"h-5 w-5 text-smd-soft-green"}):e.jsx(y,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>p(s),className:"text-gray-500 hover:text-purple-600",title:"Descargar QR",children:e.jsx(v,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>f(s),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx(b,{className:"h-5 w-5"})})]})})]},s.id))})]}),e.jsx("div",{className:"md:hidden divide-y divide-gray-200",children:i.map(s=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsx("img",{src:s.image_url,alt:s.name,className:"w-16 h-16 rounded-md object-cover mr-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-bold text-smd-dark",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.time})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Paradas:"}),e.jsx("span",{children:s.stops_count})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t mt-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-600",children:"Acciones:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{href:route("admin.routes.edit",s.slug),className:"text-blue-600",children:e.jsx(g,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>h(s),className:"text-gray-500 relative",children:x===s.id?e.jsx(w,{className:"h-6 w-6 text-smd-soft-green"}):e.jsx(y,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>p(s),className:"text-purple-600",children:e.jsx(v,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>f(s),className:"text-red-600",children:e.jsx(b,{className:"h-6 w-6"})})]})]})]})]},s.id))})]}),i.length===0&&e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-gray-500",children:"No se encontraron rutas."})}),e.jsx("div",{className:"mt-6",children:e.jsx(S,{links:R.links})}),e.jsx(A,{show:C,onClose:c,children:e.jsxs("form",{onSubmit:L,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium",children:"¿Eliminar Ruta?"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Se eliminará la ruta ",e.jsxs("span",{className:"font-bold",children:['"',j?.name,'"']})," y todas sus paradas asociadas."]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(T,{onClick:c,children:"Cancelar"}),e.jsx($,{className:"ms-3",disabled:U,children:"Eliminar Ruta"})]})]})})]})}q.layout=n=>e.jsx(D,{children:n,title:"Gestionar Rutas"});export{q as default};
